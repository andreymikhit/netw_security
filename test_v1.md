## Темы тестирования
- Пассивные сетевые атаки
- Безопасность bluetooth
- Активные сетевые атаки
- Сканер уязвимостей openvas
- Безопасность и уязвимость wi-fi
- Безопасность gsm
- Metasploit framework
- Введение в анализ сетевого трафика

> Следует учитывать, что использование подобных методов может быть незаконным и опасным.

> Ст. **273** **УК** **РФ**

> https://www.securitylab.ru

> OpenVAS

> https://habr.com/ru/articles/203766/
> https://dzen.ru/a/YlP_CLkNm2k3E9ek
> https://www.ceos3c.com/security/install-openvas-kali-linux/
> https://spy-soft.net/best-vulnerability-scanners/



Какая из приведенных аббревиатур является модулем идентификации абонента?
- **Аббревиатура** SIM расшифровывается как Subscriber Identification Module, то есть «**модуль** **идентификации** **абонента**».


* Ст. **273** **УК** **РФ**. Создание, использование и распространение вредоносных компьютерных программ.
статья 273 ук рф может быть связана с metasploit framework - если не в учебных целях и по договору


* Какую команду в Meterpreter необходимо использовать для получения дампа хэшей паролей скомпрометированной Windows системы? В каком файле хранятся хэши паролей?
hashdump
~~ meterpreter> getsystem. В файле SAM ~~
Для получения дампа хэшей паролей в Meterpreter необходимо использовать команду hashdump. Она позволяет выгрузить любые LM или NTLM хэши в целевой системе. Хэши паролей в Windows хранятся в файле SAM (Security Accounts Manager) в каталоге %systemroot%\system32\config (под %systemroot% понимается каталог с операционной системой — по умолчанию соответствует каталогу C:\WINDOWS)


* Какая из перечисленных утилит может использоваться для bruteforce-атаки на hash-паролей на GPU?
Extreme Bruteforcer EGB, Elcomsoft EDPR
~~aircrack-ng~~
Для bruteforce-атаки на hash-пароли на GPU могут использоваться следующие утилиты:
Extreme GPU Bruteforcer (EGB). Программа предназначена для восстановления паролей к хэшам различных типов, используя мощности видеопроцессора (GPU). Поддерживает алгоритмы хэширования MD5, MySQL и NTLM. 
Elcomsoft Distributed Password Recovery (EDPR). Программа содержит плагины, оптимизированные для использования видеокарт в брутфорсе. Поддерживает игровые видеокарты Nvidia, начиная с GeForce GTX 4xx и новее, AMD Radeon серий HD 5000–HD 8000, более современные AMD R9 и RX, а также профессиональные видеокарты (все серии Nvidia Quadro и AMD FirePro).


* В каких файлах хранятся захешированные пароли и учетные данные в текстовом виде в Linux-системах?
Информацию об учетных записях ОС Linux хранит в файле /etc/passwd
~~/etc/shadow~~
Он содержит следующее, где:
User ID - логин;
Password – наличие пароля;
UID - идентификатор пользователя;
GID - идентификатор группы по умолчанию;
User Info – вспомогательная информация о пользователе (полное имя, контакты и т.д.).


* Расшифруйте базовую оценку CVSSv3. В каком из векторов CVSSv3 присутствуют перечисленные метрики: сложность атаки — низкая, вектор атаки — сетевой, влияние на доступность — высокое?
L N H
~~fe80:0:0:0:200:f8ff: fe21:67cf~~
Базовая оценка (BS) в CVSSv3 включает следующие критерии:
Вектор атаки (AV). Может быть сетевым (N), смежной сетью (A), локальным (L) или физическим (P).
Сложность атаки (AC). Может быть высокой (H) или низкой (L).
Уровень привилегий (PR). Может быть высоким (H), низким (L) или не требующимся (N).
Взаимодействие с пользователем (UI). Может быть требуется (R) или не требуется (N).
Влияние на другие компоненты системы (S). Может не оказывать влияния (U) или оказывать (C).
Влияние на конфиденциальность (С). Может не оказывать влияния (N), быть низким (L) или высоким (H).
Влияние на целостность (I). Может не оказывать влияния (N), быть низким (L) или высоким (H).
Влияние на доступность (A). Может не оказывать влияния (N), быть низким (L) или высоким (H).


* С какими из перечисленных утилит можно интегрировать MSF?
Некоторые утилиты, которые можно интегрировать с Metasploit Framework (MSF):
InlineEgg. Утилита для создания ассемблерного кода средствами Python. Ассемблерные команды можно использовать для создания эффективных шёлкодов для эксплойтов. MSF имеет интерфейс для InlineEgg шёлкодов, использующий модуль ExternalPayload.
Impurity. Обеспечивает интерфейс для разработки шёлкодов на C. Результат работы можно поместить в память как исполняемый ELF-образ. MSF имеет загрузчик (только для Linux) для исполняемых файлов Impurity. 
UploadExec. Позволяет загрузить любой исполняемый Win32-файл на эксплойтируемый хост и запустить его.
~~Интеграция доступна только в платной версии~~


* Какую информацию с поддельного маршрутизатора рассылает злоумышленник для того, чтобы провести атаку на протокол RIP?
Чтобы изменить поведение RIPv1 для проведения DdoS-атаки, злоумышленник может отправить такой же запрос, подменив исходящий IP адресом объекта атаки. Адресаты выбираются по заранее подготовленному списку маршрутизаторов с поддержкой RIPv1, которые имеют подозрительно большое количество маршрутов в таблицах.
В результате одиночного запроса генерируется большое количество пакетов с 504-байтовой нагрузкой, отправляемых на атакуемый адрес. На один запрос может отправляться несколько ответов по причине ограничения в 25 маршрутов на один RIP-пакет. Со стороны атакуемого видны только ответы на запросы RIPv1, которые он, разумеется, не делал.
Навязывание ложного RIP-маршрутизатора X для перехвата трафика между сетями P и Q - возможна ситуация, когда значение вектора, объявляемого, например, маршрутизатором В: Q=1. В этом случае Х не может немедленно предложить лучшего маршрута, но он может применить следующий прием. Сначала, выбрав паузу в рассылке RIP-сообщений маршрутизатором В, Х от имени В отправляет в А вектор Q=16, что заставит маршрутизатор А удалить из своей таблицы маршрут в сеть Q, так как до этого А отправлял датаграммы в Q через В. Сразу же вслед за этим Х отправляет вектор Q=1 от своего имени, и А устанавливает маршрут в сеть Q через Х. Последующие векторы Q=1 от В будут проигнорированы, поскольку они не предлагают лучшего маршрута.


* В процессе анализа дампа мы обнаружили в ответных пакетах от интересующих нас хостов RST, ACK-флаги. Что они означают?
RST и ACK-флаги в ответных пакетах от хостов означают следующее:
RST (Reset the connection) указывает на прерывание соединения. Узел отправляет TCP-сегмент с флагом RST в ответ на полученный по соединению некорректный TCP-сегмент, из-за которого соединение не удаётся установить. Отправка RST-сегмента для активного соединения принудительно завершает соединение, из-за чего теряются данные, сохранённые в буферах отправки и получения или находящиеся в пути.
ACK (Acknowledgment field is significant) используется для подтверждения, что пакеты данных получены. Также ACK подтверждает запрос на инициацию соединения и запрос на его завершение.
Таким образом, в случае закрытого порта после SYN-пакета получатель отправляет RST- и ACK-флаги пакета TCP.
~~Ничего не значит, никак не связано с активностью на портах~~


* Какой из приведенных вариантов содержит наиболее подходящие методы защиты для сетей на базе сигнального протокола Diameter, учитывая выявленные в нем слабые места?
Для защиты сетей на базе сигнального протокола Diameter от уязвимостей рекомендуется комплексный подход.
Некоторые методы, которые могут быть использованы:
Регулярный анализ защищённости. Он поможет выявить уязвимости, оценить текущий уровень защищённости и потенциальные риски, выработать защитные меры и проверить их эффективность. Важно поддерживать параметры безопасности в актуальном состоянии и проводить анализ защищённости при любых изменениях в сети, например при изменении конфигурации или внедрении нового оборудования.
Использование активного фаервола. Такие решения контролируют SS7, Diameter, GTP и SMS-трафик, снабжаются встроенной аналитикой, способны сопоставлять происходящие события и реагировать на атаки.
Проверка легитимности сообщений. Если оператор разрешает абонентам регистрироваться в чужих сетях, сообщения, поступающие из других сетей, должны проверяться на легитимность.
Выбор наиболее подходящих методов защиты зависит от конкретных условий и требований безопасности.
~~Использовать специальные системы защиты, работающие на уровне сигнальных протоколов~~


* Какой из перечисленных методов HTTP необходимо искать в случае подозрения перехвата логина и пароля в открытом виде при разборе дампа сетевого трафика в WireShark:
POST
В случае подозрения перехвата логина и пароля в открытом виде при разборе дампа сетевого трафика в Wireshark необходимо искать метод POST. 13
Для этого нужно применить фильтр http.request.method == «POST»


* Вам нужно проверить, содержит ли WiFi-дамп полезную информацию для взлома. Выберите правильный вариант команд, которые можно для этого использовать.
airmon-ng start wlan0; ... airodump-ng wlan0mon; ... 
~~airckrack-ng /media/shr/wpa.full.cap; airmon-ng start wlan0~~
Для проверки, содержит ли WiFi-дамп полезную информацию для взлома, можно использовать следующие команды:
Перевод адаптера Wi-Fi в режим монитора. Например, для интерфейса Wlan0 нужно ввести команду airmon-ng start wlan0.
Сканирование точек доступа. Для этого используется команда airodump-ng wlan0mon. На экране появится список точек доступа в радиусе досягаемости. 
Использование инструментов для взлома. Например, для перебора паролей по словарю можно применить команду aircrack-ng handshake.cap -w dict.txt. Также для взлома с помощью радужных таблиц подойдёт инструмент cowpatty. Пример команды: cowpatty -r wifi.cap -f dict.txt -s raaj -s: SSID. Преобразование файла в стандартный хэш. Для этого можно использовать инструмент hcxpcapng. Например, команда hcxpcapngtool --john hash.john wifi.cap. Важно помнить, что использование подобных команд может быть незаконным и опасным.


* Как можно закрепиться с помощью MSF в атакуемой Windows-системе?
persistence. Выбрать и настроить эксплойт.
~~Злоумышленник может прописать вручную вредоносный файл в автозагрузку~~
Чтобы закрепиться с помощью Metasploit (MSF) в атакуемой Windows-системе, можно использовать скрипт persistence. Он создаёт бэкдор, который запускается при каждой загрузке системы.
Также для закрепления доступа можно сгенерировать полезную нагрузку с помощью MSFvenom. Затем разместить её на компьютере цели и, например, добавить файл в автозагрузку.
Ещё один способ — использовать модуль сохранения доступа (опция -S).
Важно помнить, что использование подобных методов может быть незаконным и опасным. Рекомендуется обратиться к специалисту.
Шаги по эксплуатации целевой системы с помощью MSF:
Выбрать и настроить эксплойт (код, компрометирующий конкретную уязвимость на целевой системе).
Проверить целевую систему, чтобы определить, подвержена ли она атаке с помощью эксплойта. Этот шаг является необязательным и обычно опускается, чтобы свести к минимуму обнаружение.
Выбрать и настроить полезную нагрузку (код, который будет выполняться в целевой системе, после успешной эксплуатации).
Выбрать метод кодирования, чтобы обойти средства обнаружения (идентификаторы/IP-адреса или антивирусное программное обеспечение).
Выполнить эксплойт.


* С какой целью администратор сети может включать неразборчивый режим (promiscuous mode) на сетевом интерфейсе?
Этот режим позволяет мониторить трафик только в данном коллизионном домене (для Ethernet или беспроводных сетей) или кольце (для сетей Token ring или FDDI).
~~Контролировать неавторизованные действия пользователей во внутренней сети~~
Promiscuous mode — это «неразборчивый» режим, в котором сетевая плата позволяет принимать все пакеты независимо от того, кому они адресованы.
Этот режим позволяет мониторить трафик только в данном коллизионном домене (для Ethernet или беспроводных сетей) или кольце (для сетей Token ring или FDDI).
«Неразборчивый» режим часто используется снифферами — специализированными программами, позволяющими отображать и анализировать сетевой трафик для диагностики сетевых неполадок. Такие программы позволяют легко перехватывать пароли и конфиденциальные данные, передаваемые по сети в незащищённом виде.


* Выберите один из наиболее подходящих способов, которым может воспользоваться злоумышленник для сбора информации о жертве (цели атаки), но при этом с минимальными активными действиями и оставлением следов.
Пробив. Использование ботов. Поиск в закрытых источниках. Сканирование уязвимостей.
~~OpenVAS~~
Несколько методов, которые злоумышленник может использовать для сбора информации о жертве с минимальными активными действиями и оставлением следов:
Пробив. Раскрытие конфиденциальных данных о человеке за вознаграждение. Источниками могут быть операторы сотовой связи, государственные информационные системы, банки и другие финансовые учреждения.
Использование ботов в мессенджерах. Они собирают данные из утечек.
Поиск в закрытых источниках. Злоумышленник может использовать частные источники, базы данных, платные подписки и, если потребуется, тёмную сторону интернета.
Сканирование уязвимостей. С его помощью проверяют соответствие конфигурации целевого хоста или приложения цели конкретного эксплойта, а также собирают информацию о запущенном программном обеспечении и номерах версий с помощью баннеров сервера, прослушиваемых портов или других сетевых артефактов.
Сочетание инструментов по проникновению с легальным ПО. Это позволяет минимизировать обнаружение атаки, так как доверенные программы внесены в «белые списки» систем безопасности.


* При первом старте после установки OpenVAS мы получаем уведомление в веб-интерфейсе, что не обновлены базы данных уязвимостей NVT. Каким из ниже приведенных вариантов их можно обновить?
openvas-nvt-sync, openvassd, openvasmd --rebuild, openvas-scapdata-sync, openvas-certdata-sync.
~~openvas-setup~~
Обновить базы данных уязвимостей NVT в OpenVAS можно двумя способами:
Через веб-интерфейс. Для этого нужно перейти в раздел «Администрирование» и поочерёдно обновить базы данных в разделах nvt, scap и cert.
Из командной строки. Для этого нужно выполнить следующие команды: openvas-nvt-sync, openvassd, openvasmd --rebuild, openvas-scapdata-sync, openvas-certdata-sync.
Также обновить фиды OpenVAS, включая NVTs (тесты сетевых уязвимостей), можно с помощью команды sudo gvm-feed-update. Этот процесс может занять некоторое время, так как загружает необходимые данные для сканирования уязвимостей.


* Можно ли с помощью NMap выявлять и эксплуатировать уязвимости в результатах сканирования:
Nmap позволяет выявлять уязвимости в результатах сканирования. nmap --script vuln 192.168.1.1.
~~NMap может лишь обнаруживать открытые порты и перечислять на них сервисы~~
Nmap позволяет выявлять уязвимости в результатах сканирования. Для этого в инструменте есть богатая библиотека скриптов для обнаружения конкретных уязвимостей. Например, скрипт vulscan берёт название ПО и прогоняет его по базам уязвимостей: CVE, OSVBD, SecurityFocus и SecurityTracker.
Для поиска уязвимостей можно использовать команду nmap --script vuln 192.168.1.1. Этот скрипт из NSE выполняет быстрое сканирование на наличие известных уязвимостей, что может быть полезно для первоначальной оценки безопасности системы.
Для эксплуатации уязвимостей Nmap можно использовать в сочетании с другими инструментами, например Metasploit. Metasploit Framework использует данные, полученные от Nmap, для автоматизации атак и тестов на проникновение.


* Как называется атака, в результате которой злоумышленник, подменив в заголовке пакета IP-адрес источника на IP-адрес жертвы, отправляет такие пакеты на уязвимый DNS-сервер, который в результате на пакет небольшого размера отдает пакет в несколько раз больше, из-за чего на узел жертвы происходит DDOS-атака?
TCP SYN Flood. Smurf-атаки.
~~DNS-spoofing~~
TCP SYN Flood. Цель атаки SYN Flood – вызвать перерасход ресурсов системы. На каждый входящий SYN-пакет система резервирует определенные ресурсы в памяти, генерирует ответ SYN+ACK, содержащий криптографическую информацию, осуществляет поиск в таблицах сессий и т. д. – то есть затрачивает процессорное время. Отказ в обслуживании наступает при потоке SYN Flood от 100 до 500 тыс. пакетов за секунду. А злоумышленник, имея хотя бы гигабитный канал, получает возможность направить поток до 1,5 млн пакетов в секунду.
Smurf-атаки. Атакующий посылает поддельный пакет IСМР Echo по адресу широковещательной рассылки. При этом адрес источника пакета заменяется адресом жертвы, чтобы «подставить» целевую систему. Поскольку пакет Еcho послан по широковещательному адресу, все машины усиливающей сети возвращают жертве свои ответы. Послав один пакет IСМР в сеть из 100 систем, атакующий инициирует усиление DDoS-атаки в сто раз.
Чтобы предотвратить эффект усиления, специалисты по сетевой безопасности советуют запретить операции прямой широковещательной рассылки на всех граничных маршрутизаторах. Также дополнительно стоит установить в ОС режим «тихого» отбрасывания широковещательных эхо-пакетов IСМР.


* Для чего предназначен параметр ClockOffset, передаваемый при взаимодействии Bluetooth-устройств?
Clock Offset Bluetooth-устройств — это смещение частоты тактов для каждого обнаруженного устройства.
~~Используется для установления и управления радиосоединением между двумя устройствами. Реализуется контроллером Bluetooth~~
Clock Offset Bluetooth-устройств — это смещение частоты тактов для каждого обнаруженного устройства.
В процессе поиска master-устройство получает от ответчиков значение тактового генератора. Затем, на этапе установления соединения, master-устройство передаёт предполагаемое значение смещения тактового генератора для slave-устройства, тем самым ускоряя процесс синхронизации двух генераторов.
Для чтения смещения тактов (clock offset) можно использовать команду clkoff в утилите hcitool. Она позволяет прочитать этот параметр для устройства по Bluetooth-адресу bdaddr.
Также для получения смещения между часами Bluetooth двух подключённых устройств можно использовать команду HCI Read Clock Offset.


* С каким уровнем привилегий должен быть запущен NMap, чтобы полноценно произвести TCP-сканирование и почему?
root. флаг --privileged.
~~Сканирование полноценно сработает при любом уровне привилегий~~
Для полноценного TCP-сканирования Nmap должен быть запущен с привилегиями суперпользователя (root).
Это необходимо, потому что для некоторых типов сканирования, в том числе TCP SYN, требуется отправлять и принимать сырые пакеты, а для этого нужны права пользователя root на Unix-системах. 14 Под Windows рекомендуется работать с учётной записью администратора, хотя иногда Nmap работает и с непривилегированными пользователями, когда в ОС уже загружена утилита WinPcap. 1
Однако есть способ запустить Nmap и без привилегий суперпользователя, но при этом поддержать все продвинутые функции и методы сканирования портов. Для этого нужно использовать флаг --privileged и сообщить программе через него, что у неё есть все необходимые возможности, хотя пользователь не является root.


* Сигнальный протокол для передачи служебных данных в современных 4G сетях называется:
Diameter — сигнальный протокол, используемый в телекоммуникационных сетях для передачи служебных данных.
~~SS7~~


* Что из перечисленного наиболее подходит под определение «Влияние уязвимости (Impact)»:
Confidentiality Impact (влияние на конфиденциальность). Integrity Impact (влияние на целостность). Availability Impact (влияние на доступность).
~~метод оценки безопасности компьютерных систем или сетей средствами моделирования атаки злоумышленника~~
Под определение подходят три метрики воздействия:
Confidentiality Impact (влияние на конфиденциальность). Описывает возможное прямое влияние на IT-систему в случае эксплуатации уязвимости с точки зрения разглашения данных.
Integrity Impact (влияние на целостность). Отображает влияние успешной эксплуатации уязвимости на целостность системы, связанную с достоверностью и точностью информации.
Availability Impact (влияние на доступность). 1 Учитывает атаки, потребляющие пропускную способность сети, циклы процессора или дисковое пространство, которые влияют на доступность системы.
Эти метрики описывают возможное прямое влияние на IT-систему в случае эксплуатации уязвимости независимо с точки зрения конфиденциальности, целостности и доступности.


* Можно ли и в каком разделе проводить сканирование OpenVAS, используя известные логины\пароли от сервисов (например, для тестирования на проникновение по принципу white box)?
в разделе ...
~~Можно, в разделе Administration~~


* Назовите сигнальный протокол используемый в телекоммуникационных сетях для передачи служебных данных вплоть до 4G.
Diameter — сигнальный протокол, используемый в телекоммуникационных сетях для передачи служебных данных в сетях 4G. 
~~SSDP~~


* Какая из команд используется при атаке по типу деаутентификации?
При атаке по типу деаутентификации используется команда aireplay-ng.
~~**aireplay-ng -9 wlan0**~~


* Что из перечисленных вариантов является наиболее простым методом обнаружения снифферов в сети? С чем это связано?
ARP.AntiSniff. CPM. neped. sentinel. WinSniffer. CommView. ZxSniffer. SpyNet. IRIS.
~~С помощью WireShark. Это связано с возможностью отлавливать активность себе подобных~~
Метод ARP считается наиболее простым методом обнаружения снифферов в сети. Для его использования нужно передать ARP на нешироковещательный адрес. Если машина отвечает на такой ARP своим IP-адресом, значит, она находится в прослушивающем режиме.
Простота метода связана с тем, что многие снифферы по умолчанию разрешают неизвестные локальному DNS-кэшу DNS-имена IP-адресов отлавливаемых кадров данных. Если сниффер поймает сообщение с неизвестным ему IP-адресом, он моментально отправит DNS-запрос дефолтному DNS-серверу на разрешение интересующего IP-адреса.
Также простым методом обнаружения снифферов может считаться метод DNS. Многие прослушивающие программы автоматически делают запросы обратного DNS IP-адресов, которые они видят. Таким образом, прослушивающий режим можно обнаружить при помощи просмотра DNS-траффика, который он создаёт. 


* Какой из вариантов фильтров будет корректно отрабатывать в случае, если нужно исключить IP-адрес из поиска в WireSharK?
Чтобы исключить пакеты с определённым IP-адресом из поиска в Wireshark, можно использовать оператор !=.
Пример фильтра: ip.src!=192.168.129.129
~~ip.addr !=192.168.129.129~~
